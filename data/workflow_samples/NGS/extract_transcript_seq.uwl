#@UGENE_WORKFLOW
#Uses input transcripts and genomic sequences to generate a FASTA file with the DNA sequences for the transcripts.
#Please make sure that contig or chromosome names in the transcript file(s) have corresponding entries in the input sequence(s).



workflow "Extract transcript sequences"{

    get-file-list {
        type:get-file-list;
        name:"Read Sequence(s)";
        url-in {
            dataset:"Dataset 1";
        }
    }
    get-file-list-1 {
        type:get-file-list;
        name:"Read Transcripts";
        url-in {
            dataset:"Dataset 1";
        }
    }
    multiplexer-1 {
        type:multiplexer;
        name:Multiplexer;
    }
    gffread {
        type:gffread;
        name:"Extract transcript sequences with gffread";
        url-out:extracted.fa;
    }
    files-conversion {
        type:files-conversion;
        name:"To FASTA";
        document-format:fasta;
    }
    files-conversion-1 {
        type:files-conversion;
        name:"To GTF";
        document-format:gtf;
    }


    .actor-bindings {
        get-file-list.out-url->files-conversion.in-file
        get-file-list-1.out-url->files-conversion-1.in-file
        multiplexer-1.output-data->gffread.in-data
        files-conversion.out-file->multiplexer-1.input-data-1
        files-conversion-1.out-file->multiplexer-1.input-data-2
    }

    files-conversion.url->gffread.in-data.genome
    files-conversion-1.url->gffread.in-data.transcripts
    get-file-list.url->files-conversion.in-file.url
    get-file-list-1.url->files-conversion-1.in-file.url

    .meta {
        visual {
            files-conversion {
                pos:"-755 -478";
                style:simple;
                in-file.angle:180;
                out-file.angle:360;
            }
            files-conversion-1 {
                pos:"-758 -311";
                style:simple;
                in-file.angle:180;
                out-file.angle:360;
            }
            get-file-list {
                pos:"-931 -478";
                style:ext;
                bg-color-ext:"0 128 128 64";
                out-url.angle:360;
            }
            get-file-list-1 {
                pos:"-931 -311";
                style:ext;
                bg-color-ext:"0 128 128 64";
                out-url.angle:360;
            }
            gffread {
                pos:"-281 -386";
                style:ext;
                bg-color-ext:"0 128 128 64";
                bounds:"-30 -30 153 120";
                extracted-data.angle:360;
                in-data.angle:180;
            }
            multiplexer-1 {
                pos:"-574 -387";
                style:ext;
                bg-color-ext:"0 128 128 64";
                input-data-1.angle:150;
                input-data-2.angle:210;
                output-data.angle:360;
            }
            files-conversion-1.out-file->multiplexer-1.input-data-2 {
                text-pos:"-16.3828 -28";
            }
            files-conversion.out-file->multiplexer-1.input-data-1 {
                text-pos:"-16.3828 -28";
            }
            get-file-list-1.out-url->files-conversion-1.in-file {
                text-pos:"-42.3047 -28";
            }
            get-file-list.out-url->files-conversion.in-file {
                text-pos:"-42.3047 -28";
            }
            multiplexer-1.output-data->gffread.in-data {
                text-pos:"-45 -37";
            }
        }
        wizard {
            name:"Extract Transcript Sequences Wizard";
            page {
                id:1;
                title:"Extract Transcript Sequences";
                parameters-area {
                    group {
                        title:"Input parameters";
                        label-size:120;
                        get-file-list.url-in {
                            label:"Genomic sequences";
                        }
                        get-file-list-1.url-in {
                            label:Transcripts;
                        }
                    }
                    group {
                        title:"Extracted sequences";
                        label-size:120;
                        gffread.url-out {
                            label:"Output file";
                        }
                    }
                }
            }
        }
    }
}

